import{n as r,B as l,a as c,b as u,c as i}from"./index.d619b402.js";const h={currentPage:2,perPage:10,jobKey:""},m={components:{BIconInfoCircleFill:l,BIconArrowRepeat:c,BIconSearch:u},props:{status:{}},data(){return{modal:!1,selectedItems:[],isBusy:!1,tableValues:[],isSelectedAll:!1,formData:{...h},totals:10,items:[],logItems:[],columns12:[{title:this.$t("JobKey"),slot:"jobKey",width:200,render:(e,t)=>e("div",t.row.jobKey.substring(t.row.jobKey.indexOf(".")+1,t.row.jobKey.length))},{title:this.$t("JobDesc"),key:"jobDesc"},{title:this.$t("Cron"),key:"cron"},{title:this.$t("LastFireTime"),key:"lastFireTime"},{title:this.$t("NextFireTime"),key:"nextFireTime"},{title:this.$t("Action"),slot:"action",width:200,align:"center"}],columnsLog:[{title:this.$t("FireTime"),key:"fireTime"},{title:this.$t("RunTime"),key:"runTime"}]}},computed:{onMetric(){return this.$store.getters.getMetric}},mounted(){this.fetchData(),window.abc=this},watch:{status:function(){this.fetchData()},"formData.currentPage":function(){this.fetchData()}},methods:{show(e){var t=this.items[e].jobKey;this.formData.jobKey=t,this.formData.currentPage=1,this.logItems=[],this.fetchLogData(),this.modal=!0},runNow(e){var t=this.items[e].jobKey;this.runNowRequest(t)},fetchData(){this.isBusy=!0,i.get("/jobs",{}).then(e=>{this.items=e.data.items}).finally(()=>{this.isBusy=!1})},fetchLogData(){this.isBusy=!0,i.get("/logs",{params:this.formData}).then(e=>{this.logItems=e.data.items,this.totals=e.data.totals}).finally(()=>{this.isBusy=!1})},runNowRequest(e){this.isBusy=!0,i.get("/run?jobkey="+e,{}).then(t=>{this.$Message.success(t.data)}).finally(()=>{})},pageSizeChange:function(e){this.formData.currentPage=e,this.fetchLogData()}}};var f=function(){var t=this,s=t._self._c;return s("Content",{style:{padding:"24px 0",minHeight:"280px"}},[s("Table",{attrs:{border:"",columns:t.columns12,data:t.items},scopedSlots:t._u([{key:"jobKey",fn:function({row:a}){return[t._v(" "+t._s(a.jobKey)+" ")]}},{key:"action",fn:function({row:a,index:o}){return[s("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(n){return t.show(o)}}},[t._v("\u6267\u884C\u8BB0\u5F55")]),s("Button",{attrs:{type:"warning",size:"small"},on:{click:function(n){return t.runNow(o)}}},[t._v("\u7ACB\u5373\u6267\u884C")])]}}])}),s("Modal",{attrs:{width:"900",title:"\u6267\u884C\u8BB0\u5F55"},model:{value:t.modal,callback:function(a){t.modal=a},expression:"modal"}},[s("Content",{style:{padding:"10px 0",minHeight:"280px"}},[s("Table",{attrs:{data:t.logItems,columns:t.columnsLog,stripe:""}}),s("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:t.totals,current:t.formData.currentPage,"show-total":""},on:{"on-change":t.pageSizeChange}})],1)])],1)],1)],1)},d=[],g=r(m,f,d,!1,null,"b008a26b",null,null);const b=g.exports;export{b as default};
